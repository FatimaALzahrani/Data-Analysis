<div role="tabpanel" class="tab-pane active" id="exercise-instructions">

<div id="exercice-content" class="px-5 py-3">


<h2 id="instructions">🎯&nbsp;Instructions</h2>

<p><strong>The challenge will be considered complete when you submit the URL of the document you have been working on. Make sure that the URL is in share mode and accessible by the teacher.</strong><br>
<strong>If there is no submission option on the exercise, click on the “I’m done” button.</strong></p>

<h2 id="introduction">Introduction</h2>

<p>In this challenge, the aim is to build a new Extract-Transform-Load process in BigQuery.</p>

<h3 id="greenweez-presentation">Greenweez Presentation</h3>

<p>🪴&nbsp;Greenweez is an organic e-commerce website.</p>

<p>🏷️&nbsp;It sells to B2C customers all the products allowing a healthier, more reasonable and more respectful lifestyle.</p>

<p>⚖️&nbsp;Monitoring financial equilibrium is essential if the company is to ensure a sufficient level of profitability.</p>

<h3 id="finance-team">Finance Team</h3>

<p>Here are the main missions of the finance team:</p>

<p><img src="https://wagon-public-assets.s3.eu-west-3.amazonaws.com/04-Data-Collection/01-Data-Pipelines/06-ETL-Process-With-SQL-asset-1-Untitled.png" alt=""></p>

<h3 id="context">Context</h3>

<p>Every day at Greenweez, the finance team has to analyse the number of products sold, as well as total revenue and total costs generated by sales.</p>

<p>As a member of the data team, you need to create a new data pipeline from raw data sources that are not accessible to the finance team and share with them a new set of data that will be updated daily and will include: <code>date</code>, <code>number of products</code>, <code>total turnover</code> and <code>total costs</code>.</p>

<h1 id="1---identify-and-extract-the-relevant-data">1 - Identify and Extract the Relevant Data</h1>

<ol>
<li>
<p>In BigQuery, in the&nbsp;<strong>course12</strong>&nbsp;dataset:</p>

<ul>
<li>
<p>Copy the <a href="https://console.cloud.google.com/bigquery?project=data-analytics-bootcamp-363212&amp;ws=!1m5!1m4!4m3!1sdata-analytics-bootcamp-363212!2scourse16!3sgwz_product" target="_blank">gwz_product</a> table to your BigQuery project</p>
</li>
<li>
<p>Copy the <a href="https://console.cloud.google.com/bigquery?project=data-analytics-bootcamp-363212&amp;ws=!1m5!1m4!4m3!1sdata-analytics-bootcamp-363212!2scourse16!3sgwz_sales" target="_blank">gwz_sales</a> table to your BigQuery project</p>
</li>
</ul>
</li>
<li>
<p>Analyse the structure of the two tables and identify the primary and foreign keys present in each table.</p>

<details>
<summary>Hint</summary>

<p><strong>Sales</strong></p>
<ul>
<li>Primary key - <code>orders_id</code>, <code>products_id</code></li>
<li>Foreign keys - <code>orders_id</code> for <code>gwz_ship</code> and <code>product_id</code> for <code>gwz_product</code></li>
</ul>

<p><strong>Product</strong></p>
<ul>
<li>Primary key - <code>products_id</code></li>
<li>Foreign key - <code>product_id</code> for <code>gwz_sales</code></li>
</ul>
</details>
</li>
<li>
<p>List the fields you will need in each table to perform the transformations that will enable you to calculate: the <code>number of products</code>, <code>total turnover</code> and <code>total costs</code> per day.</p>
</li>
</ol>

<h2 id="2---perform-adequate-transformations">2 - Perform Adequate Transformations</h2>

<ol>
<li>
<p>Join the two tables to display both turnover and purchase_price.</p>
</li>
<li>
<p>Use your previous query from question 4 to add a new column for&nbsp;<code>products_costs</code>, which is the purchase price multiplied by the quantity.</p>
</li>
<li>
<p>Calculate the total&nbsp;<code>number_of_products</code>, total&nbsp;<code>products_cost</code>&nbsp;and total&nbsp;<code>turnover</code>&nbsp;per day using the previous query you wrote.</p>
</li>
</ol>

<h2 id="3---create-and-update-the-new-table">3 - Create and Update the New Table</h2>

<ol>
<li>
<p>Use the CREATE OR REPLACE TABLE statement in your query editor to transform the temporary table generated by the query into a permanent table called <code>finance_day</code></p>
</li>
<li>
<p>Automate the SQL code using BigQuery scheduled queries: create a scheduled query called <code>gwz_finance_day</code> to run the query every morning at 7am and overwrite the <code>finance_day</code> table with the updated data. Use today at 7am as the start date.</p>

<p>💁🏽 Help - <a href="https://cloud.google.com/bigquery/docs/scheduling-queries#set_up_scheduled_queries" target="_blank">Create a scheduled query</a> documentation</p>
</li>
<li>
<p>Go the <a href="https://cloud.google.com/bigquery/docs/scheduling-queries#viewing_a_scheduled_query" target="_blank">scheduled query tab</a> to view your new scheduled query. Trigger an immediate manual run of your query to test it by clicking on <a href="https://cloud.google.com/bigquery/docs/scheduling-queries#set_up_a_manual_run_on_historical_dates" target="_blank">Scheduled backfill</a> and choosing the option <strong>run a one-time transfer</strong>.</p>
</li>
<li>
<p>⚠️&nbsp;<strong>Pause your scheduled query</strong> ⚠️&nbsp;(<strong>Please please</strong> 🙏🏽 make sure to pause your scheduled query to avoid fees!)</p>
</li>
</ol>

<p>Congratulations, you’ve managed to transform raw data into a new dataset that will be accessible to the finance team and updated every day with new data. 🧠</p>


</div>
</div>